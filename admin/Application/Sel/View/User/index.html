<extend name="Common@Public/base" />

{// 主体内容}
<block name="main">
	<div id="main-content">
        <div id="top-alert" class="fixed alert alert-error" style="display: none;">
            <button class="close fixed" style="margin-top: 4px;">&times;</button>
            <div class="alert-content">这是内容</div>
        </div>
	    <div id="main" class="main">
			<!-- 标题栏 -->
			<div class="main-title">
				<h2>用户查询 - 用户列表</h2>
			</div>

		    <div style="height:30px;">
				<!-- <div class="btn-group">
					<button class="btn current">未签约</button>
					<button class="btn">已签约</button>
				</div> -->
				<!-- 右边搜索 -->
				<div class="search-form fr cf">
					<div class="sleft">
						<input type="text" placeholder="请输入用户名" value="{$param.user_name}" class="search-input" name="username">
						<a url="{:ZU('sel/user/index', 'ZL_ADMIN_DOMAIN')}" id="search" href="javascript:;" class="sch-btn"><i class="btn-search"></i></a>
					</div>
		            <div class="btn-group-click adv-sch-pannel fl">
		                <button class="btn">高 级<i class="btn-arrowdown"></i></button>
		                <div class="dropdown cf" style="display: none;">
		                	<div class="row">
		                		<label>邮箱：</label>
		                		<input type="text" placeholder="请输入邮箱" value="{$param.user_email}" class="text input-2x" name="email">
		                	</div>
		                	<div class="row">
		                		<label>手机号：</label>
		                		<input type="text" placeholder="请输入手机号" value="{$param.user_mobile}" class="text input-2x" name="mobile">
		                	</div>
		                </div>
		                <button class="btn clear-param">清空条件</button>
		            </div>
				</div>
				<!-- /右边搜索 -->
		    </div>

			<!-- 数据列表 -->
			<div class="data-table">
				<table class="">
				    <thead>
				        <tr>
						<th class="">用户id</th>
						<th class="">用户名</th>
						<th class="">用户昵称</th>
						<th class="">最后登录时间</th>
						<th class="">最后登录IP</th>
						<th class="">操作</th>
						</tr>
				    </thead>
				    <tbody>
				    	<?php foreach($user_list as $val):?>
						<tr>
							<td>{$val.user_id}</td>
							<td>{$val.user_name}</td>
							<td>{$val.user_nickname|default="暂未设置"}</td>
							<td>{$val.user_login_time}</td>
							<td>{$val.user_login_ip}</td>
							<td>
								<a href="{:ZU('sel/user/show', 'ZL_ADMIN_DOMAIN', array('user_id'=>$val['user_id']))}" class="btn">查看</a>
							</td>
						</tr>
						<?php endforeach;?>
					</tbody>
			    </table>
			</div>

			<div class="controls"></div>

			<!-- 分页 -->
			<?php if(!empty($page)):?>
			<div class="controls fr">
				<div class="page">{$page}</div>
			</div>
			<?php endif;?>
	    </div>
    </div>
</block>

<block name="js">
<link href="__JS__/datetimepicker/css/datetimepicker.css" rel="stylesheet" type="text/css">
<link href="__JS__/datetimepicker/css/dropdown.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="__JS__/datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="__JS__/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script>
<script type="text/javascript">
$(function(){
	//搜索功能
	$("#search").click(function(){
		var url = $(this).attr('url');
        var query  = $('.search-form').find('input').serialize();
        query = query.replace(/(&|^)(\w*?\d*?\-*?_*?)*?=?((?=&)|(?=$))/g,'');
        query = query.replace(/^&/g,'');

        if( url.indexOf('?')>0 ){
            url += '&' + query;
        }else{
            url += '?' + query;
        }
		window.location.href = url;
	});

	$('.clear-param').on('click', function(){
		var url = $('#search').attr('url');
		window.location.href = url;
	});

	/* 状态搜索子菜单 */
	$(".search-form").find(".drop-down").hover(function(){
		$(this).find(".drop-down-menu").removeClass("hidden");
	},function(){
		$(this).find(".drop-down-menu").addClass("hidden");
	});
	$(".drop-down-menu li").find("a").each(function(){
		var parent = $(this).parents('.drop-down');
		$(this).click(function(){
			var text = $(this).text();
			parent.find('.sort-txt').text(text).attr("data",$(this).attr("value"));
			parent.find('.drop-down-menu').addClass("hidden");
		})
	});

	//只有一个模型时，点击新增
	$('.document_add').click(function(){
		var url = $(this).attr('url');
		if(url != undefined && url != ''){
			window.location.href = url;
		}
	});

	//点击排序
	$('.list_sort').click(function(){
		var url = $(this).attr('url');
		var ids = $('.ids:checked');
		var param = '';
		if(ids.length > 0){
			var str = new Array();
			ids.each(function(){
				str.push($(this).val());
			});
			param = str.join(',');
		}

		if(url != undefined && url != ''){
			window.location.href = url + '/ids/' + param;
		}
	});

    //回车自动提交
    $('.search-form').find('input').keyup(function(event){
        if(event.keyCode===13){
            $("#search").click();
        }
    });

    $('#time-start').datetimepicker({
        format: 'yyyy-mm-dd',
        language:"zh-CN",
	    minView:2,
	    autoclose:true
    });

    $('#time-end').datetimepicker({
        format: 'yyyy-mm-dd',
        language:"zh-CN",
	    minView:2,
	    autoclose:true
    });
})
</script>
<script type="text/javascript">
    jQuery(function($){
        $.menu('kefu', 'select', 'user-select');
    });
</script>   
</block>