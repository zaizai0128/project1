<div class="modal-header no-padding">
	<div class="table-header">
		<i class="icon-lock"></i>
		<button type="button" class="close" data-dismiss="modal">&times;</button>
		添加管理员用户
	</div>
</div>

<div class="modal-body overflow-visible">
	<div class="control-group">
		<label class="control-label" for="username">用户名</label>
		<div class="controls">
			<input type="text" required="required" id="username" name="username" placeholder="用户名" maxlength="10"/>
		</div>
	</div>

	<div class="control-group">
		<label class="control-label" for="password">密码</label>
		<div class="controls">
			<input type="text" required="required" id="password" name="password" placeholder="密码" maxlength="10"/>
		</div>
	</div>

	<div class="control-group">
		<label class="control-label">头像</label>
		<div class="controls">
			<img src="/Public/Assets/avatars/no.png" class="nav-user-photo" style="width:32px;height:32px;">
		</div>
	</div>

	<div class="control-group">
		<div class="controls">
			<input type="file" name="pic" id="file-image" onchange="$.uploadFile('{:U('Admin/Manager/pic')}', 'file-image', 'nav-user-photo');" style="overflow:hidden;width:150px;"/>
			<input type="hidden" name="image" value="0" id="hidden-image"/>
		</div>
	</div>

	<div class="control-group">
		<label class="control-label" for="gid">角色</label>
		<div class="controls">
			<select name="gid" id="gid">
				<option value="1">管理员</option>
				<option value="2">编辑</option>
				<option value="3">客服</option>
			</select>
		</div>
	</div>
</div>

<div class="modal-footer">
	<button data-dismiss="modal" class="btn btn-small">
		<i class="icon-remove"></i>
		取消
	</button>
	<button type="button" class="btn btn-small btn-primary" onclick="$.addManager('{:U('Admin/Manager/doAdd')}', this);">
		<i class="icon-ok"></i>确认
	</button>
</div>

<script type="text/javascript" src="__PUBLIC__/HomeStyle/js/ajaxfileupload.js"></script>
<script type="text/javascript">
	jQuery(function($){

		$.extend({
			addManager : function(url, obj)
			{
				var obj = $(obj).parents('form');

				$.ajax({
					url : url,
					type : 'post',
					data : obj.serialize(),
					success : function(res)
					{
						$.lagou.alert(res.msg, res.code, 2);
						$.lagou.formHide();
					}
				});
			},

			 /**
             * @param string 上传地址
             * @param string file表单id
             * @param string 要修改的dom节点
             */
            uploadFile : function(url, file_id, class_id) 
            {
                var url = url;
                var file_id = file_id;
                var file_obj = $('#'+file_id);
                var class_obj = $('.'+class_id);
                $.ajaxFileUpload({
                    url : url,
                    fileElementId : file_id,
                    secureuri: false,
                    dataType : 'json',
                    type : 'post',
                    success : function(data) {
                        data.url = data.url + '?' + parseInt(Math.random()*10000);
                        class_obj.attr('src', data.url);
                        $('#hidden-image').val(1);
                    }
                })
            }
		});
	});
</script>